<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Buyer Dashboard - BookMarket</title>
        <meta
            name="description"
            content="Track your orders, manage your wishlist, and discover new books on your BookMarket buyer dashboard."
        />

        <!-- CSS -->
        <link rel="stylesheet" href="../css/styles.css" />

        <!-- FontAwesome -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />

        <!-- Favicon -->
        <link rel="icon" type="image/x-icon" href="../assets/img/favicon.ico" />
    </head>
    <body>
        <!-- Navigation -->
        <div id="navbar-container"></div>

        <!-- Main Content -->
        <main
            style="
                padding-top: 100px;
                min-height: 100vh;
                background: var(--light-gray);
            "
        >
            <div class="container">
                <!-- Buyer Header -->
                <div
                    class="buyer-header"
                    style="
                        background: white;
                        padding: 2rem;
                        border-radius: var(--border-radius);
                        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                        margin-bottom: 2rem;
                    "
                >
                    <div class="d-flex justify-between align-center">
                        <div class="d-flex align-center gap-3">
                            <div
                                style="
                                    width: 80px;
                                    height: 80px;
                                    background: var(--primary-navy);
                                    border-radius: 50%;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    color: white;
                                    font-weight: bold;
                                    font-size: 1.5rem;
                                "
                            >
                                <i class="fas fa-user"></i>
                            </div>
                            <div>
                                <h1
                                    id="welcomeMessage"
                                    style="
                                        margin: 0;
                                        color: var(--primary-navy);
                                    "
                                >
                                    Welcome back!
                                </h1>
                                <p
                                    id="userInfo"
                                    style="margin: 0; color: var(--text-light)"
                                >
                                    Book lover since today
                                </p>
                            </div>
                        </div>
                        <div
                            class="buyer-actions"
                            style="display: flex; gap: 1rem"
                        >
                            <a
                                href="#"
                                onclick="navigateBrowse()"
                                class="btn btn-primary"
                            >
                                <i class="fas fa-search"></i>
                                Browse Books
                            </a>
                            <button class="btn btn-outline" onclick="logout()">
                                <i class="fas fa-sign-out-alt"></i>
                                Logout
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div
                    class="buyer-stats mb-4"
                    style="
                        display: grid;
                        grid-template-columns: repeat(
                            auto-fit,
                            minmax(200px, 1fr)
                        );
                        gap: 1rem;
                    "
                >
                    <div
                        class="stat-card"
                        style="
                            background: white;
                            padding: 1.5rem;
                            border-radius: var(--border-radius);
                            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                            text-align: center;
                        "
                    >
                        <div
                            style="
                                font-size: 2rem;
                                color: var(--secondary-gold);
                                margin-bottom: 0.5rem;
                            "
                        >
                            <i class="fas fa-shopping-bag"></i>
                        </div>
                        <div
                            style="
                                font-size: 2rem;
                                font-weight: bold;
                                color: var(--primary-navy);
                                margin-bottom: 0.5rem;
                            "
                        >
                            15
                        </div>
                        <p style="margin: 0; color: var(--text-light)">
                            Books Purchased
                        </p>
                    </div>

                    <div
                        class="stat-card"
                        style="
                            background: white;
                            padding: 1.5rem;
                            border-radius: var(--border-radius);
                            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                            text-align: center;
                        "
                    >
                        <div
                            style="
                                font-size: 2rem;
                                color: var(--error);
                                margin-bottom: 0.5rem;
                            "
                        >
                            <i class="fas fa-heart"></i>
                        </div>
                        <div
                            style="
                                font-size: 2rem;
                                font-weight: bold;
                                color: var(--primary-navy);
                                margin-bottom: 0.5rem;
                            "
                        >
                            8
                        </div>
                        <p style="margin: 0; color: var(--text-light)">
                            Wishlist Items
                        </p>
                    </div>

                    <div
                        class="stat-card"
                        style="
                            background: white;
                            padding: 1.5rem;
                            border-radius: var(--border-radius);
                            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                            text-align: center;
                        "
                    >
                        <div
                            style="
                                font-size: 2rem;
                                color: var(--success);
                                margin-bottom: 0.5rem;
                            "
                        >
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div
                            style="
                                font-size: 2rem;
                                font-weight: bold;
                                color: var(--primary-navy);
                                margin-bottom: 0.5rem;
                            "
                        >
                            $347
                        </div>
                        <p style="margin: 0; color: var(--text-light)">
                            Total Spent
                        </p>
                    </div>
                </div>

                <!-- Main Content -->
                <div
                    style="
                        display: grid;
                        grid-template-columns: 2fr 1fr;
                        gap: 2rem;
                    "
                >
                    <!-- Left Column -->
                    <div>
                        <!-- Recent Orders -->
                        <div class="card mb-3">
                            <div class="card-content">
                                <div
                                    class="d-flex justify-between align-center mb-3"
                                >
                                    <h2
                                        style="
                                            margin: 0;
                                            color: var(--primary-navy);
                                        "
                                    >
                                        <i class="fas fa-shopping-bag"></i>
                                        Recent Orders
                                    </h2>
                                    <a
                                        href="order-history.html"
                                        class="btn btn-outline btn-sm"
                                    >
                                        View All Orders
                                    </a>
                                </div>

                                <div class="orders-list">
                                    <div
                                        class="order-item"
                                        style="
                                            background: var(--light-gray);
                                            padding: 1.5rem;
                                            border-radius: var(--border-radius);
                                            margin-bottom: 1rem;
                                        "
                                    >
                                        <div
                                            class="d-flex justify-between align-center mb-2"
                                        >
                                            <div>
                                                <h4
                                                    style="
                                                        margin: 0;
                                                        color: var(
                                                            --primary-navy
                                                        );
                                                    "
                                                >
                                                    Order #BM-2024-0234
                                                </h4>
                                                <small
                                                    style="
                                                        color: var(
                                                            --text-light
                                                        );
                                                    "
                                                    >Placed on March 15,
                                                    2024</small
                                                >
                                            </div>
                                            <span
                                                style="
                                                    background: var(--success);
                                                    color: white;
                                                    padding: 0.25rem 0.75rem;
                                                    border-radius: 20px;
                                                    font-size: 0.9rem;
                                                "
                                            >
                                                Delivered
                                            </span>
                                        </div>
                                        <div
                                            style="
                                                display: grid;
                                                grid-template-columns: auto 1fr auto;
                                                gap: 1rem;
                                                align-items: center;
                                            "
                                        >
                                            <img
                                                src="https://via.placeholder.com/60x75/1e2a5a/ffffff?text=Book"
                                                alt="Book"
                                                style="
                                                    width: 50px;
                                                    height: 65px;
                                                    object-fit: cover;
                                                    border-radius: 4px;
                                                "
                                            />
                                            <div>
                                                <strong
                                                    style="
                                                        color: var(
                                                            --primary-navy
                                                        );
                                                    "
                                                    >Clean Code</strong
                                                >
                                                <p
                                                    style="
                                                        margin: 0;
                                                        color: var(
                                                            --text-light
                                                        );
                                                        font-size: 0.9rem;
                                                    "
                                                >
                                                    by Robert C. Martin
                                                </p>
                                                <p
                                                    style="
                                                        margin: 0;
                                                        color: var(
                                                            --text-light
                                                        );
                                                        font-size: 0.9rem;
                                                    "
                                                >
                                                    Seller: BookStore Pro
                                                </p>
                                            </div>
                                            <div style="text-align: right">
                                                <div
                                                    style="
                                                        font-weight: bold;
                                                        color: var(
                                                            --secondary-gold
                                                        );
                                                    "
                                                >
                                                    $45.99
                                                </div>
                                                <div
                                                    style="
                                                        display: flex;
                                                        gap: 0.5rem;
                                                        margin-top: 0.5rem;
                                                    "
                                                >
                                                    <button
                                                        class="btn btn-outline btn-sm"
                                                    >
                                                        <i
                                                            class="fas fa-star"
                                                        ></i>
                                                        Rate
                                                    </button>
                                                    <button
                                                        class="btn btn-primary btn-sm"
                                                        onclick="trackOrder('ORD001')"
                                                    >
                                                        <i
                                                            class="fas fa-truck"
                                                        ></i>
                                                        Track Order
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div
                                        class="order-item"
                                        style="
                                            background: var(--light-gray);
                                            padding: 1.5rem;
                                            border-radius: var(--border-radius);
                                            margin-bottom: 1rem;
                                        "
                                    >
                                        <div
                                            class="d-flex justify-between align-center mb-2"
                                        >
                                            <div>
                                                <h4
                                                    style="
                                                        margin: 0;
                                                        color: var(
                                                            --primary-navy
                                                        );
                                                    "
                                                >
                                                    Order #BM-2024-0221
                                                </h4>
                                                <small
                                                    style="
                                                        color: var(
                                                            --text-light
                                                        );
                                                    "
                                                    >Placed on March 12,
                                                    2024</small
                                                >
                                            </div>
                                            <span
                                                style="
                                                    background: var(--warning);
                                                    color: white;
                                                    padding: 0.25rem 0.75rem;
                                                    border-radius: 20px;
                                                    font-size: 0.9rem;
                                                "
                                            >
                                                In Transit
                                            </span>
                                        </div>
                                        <div
                                            style="
                                                display: grid;
                                                grid-template-columns: auto 1fr auto;
                                                gap: 1rem;
                                                align-items: center;
                                            "
                                        >
                                            <img
                                                src="https://via.placeholder.com/60x75/d4af37/ffffff?text=Book"
                                                alt="Book"
                                                style="
                                                    width: 50px;
                                                    height: 65px;
                                                    object-fit: cover;
                                                    border-radius: 4px;
                                                "
                                            />
                                            <div>
                                                <strong
                                                    style="
                                                        color: var(
                                                            --primary-navy
                                                        );
                                                    "
                                                    >Atomic Habits</strong
                                                >
                                                <p
                                                    style="
                                                        margin: 0;
                                                        color: var(
                                                            --text-light
                                                        );
                                                        font-size: 0.9rem;
                                                    "
                                                >
                                                    by James Clear
                                                </p>
                                                <p
                                                    style="
                                                        margin: 0;
                                                        color: var(
                                                            --text-light
                                                        );
                                                        font-size: 0.9rem;
                                                    "
                                                >
                                                    Seller: Study Central
                                                </p>
                                            </div>
                                            <div style="text-align: right">
                                                <div
                                                    style="
                                                        font-weight: bold;
                                                        color: var(
                                                            --secondary-gold
                                                        );
                                                    "
                                                >
                                                    $16.99
                                                </div>
                                                <div style="margin-top: 0.5rem">
                                                    <button
                                                        class="btn btn-outline btn-sm"
                                                        onclick="trackOrder('ORD002')"
                                                    >
                                                        <i
                                                            class="fas fa-truck"
                                                        ></i>
                                                        Track
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div>
                        <!-- Quick Actions -->
                        <div class="card mb-3">
                            <div class="card-content">
                                <h3
                                    style="
                                        margin-bottom: 1.5rem;
                                        color: var(--primary-navy);
                                    "
                                >
                                    <i class="fas fa-bolt"></i>
                                    Quick Actions
                                </h3>

                                <div style="display: grid; gap: 1rem">
                                    <a
                                        href="../common/browse.html"
                                        class="btn btn-primary"
                                        style="
                                            width: 100%;
                                            text-decoration: none;
                                        "
                                    >
                                        <i class="fas fa-search"></i>
                                        Browse Books
                                    </a>
                                    <a
                                        href="cart.html"
                                        class="btn btn-outline"
                                        style="
                                            width: 100%;
                                            text-decoration: none;
                                        "
                                    >
                                        <i class="fas fa-shopping-cart"></i>
                                        View Cart
                                    </a>
                                    <a
                                        href="../common/profile.html"
                                        class="btn btn-outline"
                                        style="
                                            width: 100%;
                                            text-decoration: none;
                                        "
                                    >
                                        <i class="fas fa-user-edit"></i>
                                        Edit Profile
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Wishlist -->
                        <div class="card mb-3">
                            <div class="card-content">
                                <div
                                    class="d-flex justify-between align-center mb-3"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            color: var(--primary-navy);
                                        "
                                    >
                                        <i class="fas fa-heart"></i>
                                        My Wishlist
                                    </h3>
                                    <span
                                        style="
                                            background: var(--secondary-gold);
                                            color: white;
                                            padding: 0.25rem 0.75rem;
                                            border-radius: 20px;
                                            font-size: 0.9rem;
                                        "
                                    >
                                        8 items
                                    </span>
                                </div>

                                <div class="wishlist-items">
                                    <div
                                        class="wishlist-item"
                                        style="
                                            display: flex;
                                            gap: 1rem;
                                            padding: 1rem;
                                            border: 1px solid var(--border-gray);
                                            border-radius: var(--border-radius);
                                            margin-bottom: 1rem;
                                        "
                                    >
                                        <img
                                            src="https://via.placeholder.com/50x65/1e2a5a/ffffff?text=Book"
                                            alt="Book"
                                            style="
                                                width: 40px;
                                                height: 52px;
                                                object-fit: cover;
                                                border-radius: 4px;
                                            "
                                        />
                                        <div style="flex: 1">
                                            <h5
                                                style="
                                                    margin: 0 0 0.25rem;
                                                    color: var(--primary-navy);
                                                    font-size: 0.9rem;
                                                "
                                            >
                                                The Psychology of Money
                                            </h5>
                                            <p
                                                style="
                                                    margin: 0;
                                                    color: var(--text-light);
                                                    font-size: 0.8rem;
                                                "
                                            >
                                                Morgan Housel
                                            </p>
                                            <p
                                                style="
                                                    margin: 0;
                                                    color: var(
                                                        --secondary-gold
                                                    );
                                                    font-weight: bold;
                                                    font-size: 0.9rem;
                                                "
                                            >
                                                $22.99
                                            </p>
                                        </div>
                                        <div
                                            style="
                                                display: flex;
                                                flex-direction: column;
                                                gap: 0.5rem;
                                            "
                                        >
                                            <button
                                                class="btn btn-primary btn-sm"
                                                onclick="addToCart('The Psychology of Money')"
                                            >
                                                <i class="fas fa-cart-plus"></i>
                                            </button>
                                            <button
                                                class="btn btn-outline btn-sm"
                                                onclick="removeFromWishlist(this, 'The Psychology of Money')"
                                            >
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </div>

                                    <div
                                        class="wishlist-item"
                                        style="
                                            display: flex;
                                            gap: 1rem;
                                            padding: 1rem;
                                            border: 1px solid var(--border-gray);
                                            border-radius: var(--border-radius);
                                            margin-bottom: 1rem;
                                        "
                                    >
                                        <img
                                            src="https://via.placeholder.com/50x65/d4af37/ffffff?text=Book"
                                            alt="Book"
                                            style="
                                                width: 40px;
                                                height: 52px;
                                                object-fit: cover;
                                                border-radius: 4px;
                                            "
                                        />
                                        <div style="flex: 1">
                                            <h5
                                                style="
                                                    margin: 0 0 0.25rem;
                                                    color: var(--primary-navy);
                                                    font-size: 0.9rem;
                                                "
                                            >
                                                Design Patterns
                                            </h5>
                                            <p
                                                style="
                                                    margin: 0;
                                                    color: var(--text-light);
                                                    font-size: 0.8rem;
                                                "
                                            >
                                                Gang of Four
                                            </p>
                                            <p
                                                style="
                                                    margin: 0;
                                                    color: var(
                                                        --secondary-gold
                                                    );
                                                    font-weight: bold;
                                                    font-size: 0.9rem;
                                                "
                                            >
                                                $67.99
                                            </p>
                                        </div>
                                        <div
                                            style="
                                                display: flex;
                                                flex-direction: column;
                                                gap: 0.5rem;
                                            "
                                        >
                                            <button
                                                class="btn btn-primary btn-sm"
                                                onclick="addToCart('Design Patterns')"
                                            >
                                                <i class="fas fa-cart-plus"></i>
                                            </button>
                                            <button
                                                class="btn btn-outline btn-sm"
                                                onclick="removeFromWishlist(this, 'Design Patterns')"
                                            >
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="text-center">
                                        <a
                                            href="../buyer/wishlist.html"
                                            class="btn btn-outline btn-sm"
                                        >
                                            <i class="fas fa-heart"></i>
                                            View All Wishlist
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Recommendations -->
                        <div class="card">
                            <div class="card-content">
                                <h3
                                    style="
                                        margin-bottom: 1.5rem;
                                        color: var(--primary-navy);
                                    "
                                >
                                    <i class="fas fa-magic"></i>
                                    Recommended for You
                                </h3>

                                <div class="recommendations">
                                    <div
                                        class="recommendation-item"
                                        style="
                                            text-align: center;
                                            margin-bottom: 1rem;
                                        "
                                    >
                                        <img
                                            src="https://via.placeholder.com/80x100/1e2a5a/ffffff?text=Rec1"
                                            alt="Book"
                                            style="
                                                width: 60px;
                                                height: 75px;
                                                object-fit: cover;
                                                border-radius: 4px;
                                                margin: 0 auto 0.5rem;
                                            "
                                        />
                                        <h5
                                            style="
                                                margin: 0 0 0.25rem;
                                                color: var(--primary-navy);
                                                font-size: 0.8rem;
                                            "
                                        >
                                            Thinking, Fast and Slow
                                        </h5>
                                        <p
                                            style="
                                                margin: 0 0 0.5rem;
                                                color: var(--text-light);
                                                font-size: 0.7rem;
                                            "
                                        >
                                            Daniel Kahneman
                                        </p>
                                        <p
                                            style="
                                                margin: 0 0 0.5rem;
                                                color: var(--secondary-gold);
                                                font-weight: bold;
                                                font-size: 0.8rem;
                                            "
                                        >
                                            $19.99
                                        </p>
                                        <button
                                            class="btn btn-primary btn-sm"
                                            style="
                                                font-size: 0.7rem;
                                                padding: 0.25rem 0.5rem;
                                            "
                                        >
                                            <i class="fas fa-heart"></i>
                                            Add to Wishlist
                                        </button>
                                    </div>

                                    <div
                                        class="recommendation-item"
                                        style="
                                            text-align: center;
                                            margin-bottom: 1rem;
                                        "
                                    >
                                        <img
                                            src="https://via.placeholder.com/80x100/d4af37/ffffff?text=Rec2"
                                            alt="Book"
                                            style="
                                                width: 60px;
                                                height: 75px;
                                                object-fit: cover;
                                                border-radius: 4px;
                                                margin: 0 auto 0.5rem;
                                            "
                                        />
                                        <h5
                                            style="
                                                margin: 0 0 0.25rem;
                                                color: var(--primary-navy);
                                                font-size: 0.8rem;
                                            "
                                        >
                                            The Lean Startup
                                        </h5>
                                        <p
                                            style="
                                                margin: 0 0 0.5rem;
                                                color: var(--text-light);
                                                font-size: 0.7rem;
                                            "
                                        >
                                            Eric Ries
                                        </p>
                                        <p
                                            style="
                                                margin: 0 0 0.5rem;
                                                color: var(--secondary-gold);
                                                font-weight: bold;
                                                font-size: 0.8rem;
                                            "
                                        >
                                            $18.99
                                        </p>
                                        <button
                                            class="btn btn-primary btn-sm"
                                            style="
                                                font-size: 0.7rem;
                                                padding: 0.25rem 0.5rem;
                                            "
                                        >
                                            <i class="fas fa-heart"></i>
                                            Add to Wishlist
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <div id="footer-container"></div>

        <!-- JavaScript -->
        <script src="../js/main.js"></script>
        <script>
            // Load navigation and footer with proper auth state
            loadNavbarAndInitialize();

            fetch("../components/footer.html")
                .then((response) => response.text())
                .then((data) => {
                    document.getElementById("footer-container").innerHTML =
                        data;
                });

            // Update user information from localStorage
            function updateUserInfo() {
                const userInfo = JSON.parse(
                    localStorage.getItem("userInfo") || "null"
                );
                if (userInfo) {
                    const welcomeMessage =
                        document.getElementById("welcomeMessage");
                    const userInfoEl = document.getElementById("userInfo");

                    if (welcomeMessage) {
                        welcomeMessage.textContent = `Welcome back, ${
                            userInfo.name || userInfo.email.split("@")[0]
                        }!`;
                    }

                    if (userInfoEl) {
                        const loginDate = new Date(
                            userInfo.loginTime
                        ).toLocaleDateString();
                        userInfoEl.textContent = `${
                            userInfo.type.charAt(0).toUpperCase() +
                            userInfo.type.slice(1)
                        } since ${loginDate}`;
                    }
                }
            }

            // Call on page load
            document.addEventListener("DOMContentLoaded", updateUserInfo);

            // Buyer functionality
            function addToCart(bookTitle) {
                showAlert(`"${bookTitle}" added to cart!`, "success");
            }

            function removeFromWishlist(button, bookTitle) {
                if (true) {
                    const item = button.closest(".wishlist-item");
                    item.style.opacity = "0.5";
                    item.innerHTML = `
                    <div class="text-center p-2">
                        <i class="fas fa-heart-broken" style="color: var(--error); margin-bottom: 0.5rem;"></i>
                        <p style="margin: 0; color: var(--error); font-size: 0.8rem;">Removed from wishlist</p>
                    </div>
                `;
                    showAlert(`"${bookTitle}" removed from wishlist`, "info");
                }
            }

            function viewBook(bookTitle) {
                showAlert(`Opening "${bookTitle}"...`, "info");
                setTimeout(() => {
                    window.location.href = "book-details.html";
                }, 1000);
            }

            function clearHistory() {
                if (true) {
                    const recentlyViewed =
                        document.querySelector(".recently-viewed");
                    recentlyViewed.innerHTML = `
                    <div class="text-center" style="grid-column: 1 / -1; padding: 2rem; color: var(--text-light);">
                        <i class="fas fa-history" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>Your viewing history has been cleared</p>
                    </div>
                `;
                    showAlert("Viewing history cleared", "success");
                }
            }

            // Note: logout() function is now handled by main.js

            // Responsive styles
            const style = document.createElement("style");
            style.textContent = `
            @media (max-width: 768px) {
                .buyer-header .d-flex {
                    flex-direction: column !important;
                    gap: 1rem;
                    text-align: center;
                }
                .buyer-actions {
                    flex-direction: column !important;
                    width: 100%;
                }
                main > .container > div:last-child {
                    grid-template-columns: 1fr !important;
                }
                .order-item > div:last-child {
                    grid-template-columns: 1fr !important;
                    text-align: center;
                    gap: 1rem;
                }
                .recently-viewed {
                    grid-template-columns: repeat(2, 1fr) !important;
                }
                .wishlist-item {
                    flex-direction: column !important;
                    text-align: center;
                }
                .wishlist-item > div:last-child {
                    flex-direction: row !important;
                    justify-content: center;
                }
            }
        `;
            document.head.appendChild(style);
        </script>
    </body>
</html>
